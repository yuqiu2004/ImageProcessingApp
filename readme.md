## 应用程序

> 注意：界面精细一点

### 实验目的：

-  掌握多线程编程在图像处理中的应用。
- 理解图像处理的基本概念和算法。
- 熟练运用Windows API进行GUI界面设计和图像处理。

### 实验步骤：

1. 设计GUI界面：设计一个GUI界面(不限于winform，wpf等)，用于选择图像文件、设置处理参数和显示处理结果。对选中处理完毕的文件，同时展示原图和处理之后的图。
2. 实现多线程图像处理：为每个图像文件创建一个独立的线程负责处理，处理内容包括灰度处理、放大至200%、缩小至50%、顺时针旋转90°、逆时针旋转90°等。使用图像处理库（如OpenCV）进行图像处理。

   使用OpenCVSharp类库实现
3. 更新处理进度：线程之间通过消息机制（如Windows消息或自定义同步机制）更新处理进度，GUI界面根据接收到的消息实时显示处理进度。（“[待处理]”，“[处理中]”，“[处理完毕]”）
4. 实现取消处理功能：在GUI界面上创建一个取消处理按钮，当点击该按钮时，通过消息或**信号量**通知对应线程停止处理并关闭线程。

### 预期结果：

- GUI界面能够正确显示图像文件和提供图像处理功能。

- 多线程图像处理能够高效稳定地进行。

- 程序能够正确关闭所有线程并释放资源。

###  界面示例：

<img src=".\assets\Snipaste_2024-12-28_23-35-20.png" style="zoom:60%;" />

### 要求：

1. 能完成基本框架60分
2. 完成指定处理内容（灰度处理、放大至200%、缩小至50%、顺时针旋转90°、逆时针旋转90°，每个功能点5分）
3. 完成上述指定的处理内容的基础上可自由扩充，每扩充一项加5分，最多加15分。

## 作业报告

- 格式规范
- 算法用程序流程图 不要用代码
- 综合阐述实验过程及解决问题的方式方法
- 展示实验结果。
- 课程学习总结



## 实现过程问题

1. ~~DllNotFoundException: Unable to load DLL 'OpenCvSharpExtern' or one of its dependencies: 找不到指定的模块。 (0x8007007E)~~

   > opencvsharp依赖需要opencvsharp.runtime.win

2. ~~运行没有反应 -- 没有捕获异常~~

3. ~~数据更新无法及时响应到ui -- 通过获取属性的方式显示 而非tostring~~

4. ~~主线程被阻塞问题~~

5. ~~缩放图片预览问题~~

> 接口文档地址：https://learn.microsoft.com/zh-cn/dotnet/api

## todo

- [x] ui更新问题
- [x] 多线程处理
- [x] 多线程通信 更新进度
- [x] 处理完成后删除bug
- [x] 取消处理
- [x] 扩展功能 +3
- [x] 展示处理结果 对比
- [x] 清空功能
- [x] 查看结果 放大缩小效果呈现
- [x] 美化界面
  - [x] 主页面
  - [x] 查看结果页面
